{% extends 'layout/base.html' %}

{% block content %}
<div class="row mt-5">
    <div class="col-2"></div>
    <div class="col-8">
        <h2>Session: {{ session.name }}</h2>
        <hr>
    </div>
    <div class="col-2"></div>
</div>

<div class="row">
    <div class="col-2"></div>
    <div class="col-8">
        <form method="post" action="{{ url_for('sessions.action', session_id=session.id) }}" class="float-left">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <button class="btn" type="submit" name="action" value="start" title="Start"><i class="fas fa-play-circle fa-2x text-success"></i></button>
            <button class="btn" type="submit" name="action" value="pause" title="Pause"><i class="fas fa-pause-circle fa-2x text-warning"></i></button>
            <button class="btn" type="submit" name="action" value="stop" title="Stop"><i class="fas fa-stop-circle fa-2x text-danger"></i></button>
        </form>

        <div class="float-right">
            <a href="{{ url_for('sessions.setup_hashes', session_id=session.id) }}" class="Hashes"><i class="fas fa-hashtag fa-2x"></i></a>
            <a href="{{ url_for('sessions.setup_hashcat', session_id=session.id) }}" class="Hashcat Settings"><i class="fas fa-cogs fa-2x"></i></a>
        </div>
    </div>
    <div class="col-2"></div>
</div>

<div class="row mt-3">
    <div class="col-2"></div>
    <div class="col-4">
        <div class="card">
            <h3 class="card-header">Details</h3>
            <div class="card-body">
                <ul class="list-group">
                    <li class="list-group-item">
                        <div class="float-left">Session ID</div>
                        <div class="float-right">{{ session.id }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Name</div>
                        <div class="float-right">{{ session.name }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Created At</div>
                        <div class="float-right">{{ session.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Active</div>
                        <div class="float-right">{{ 'Yes' if session.active else 'No' }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Hashcat Configured</div>
                        <div class="float-right">{{ 'Yes' if session.hashcat.configured else 'No' }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Cracking Mode</div>
                        <div class="float-right">{{ 'Wordlist' if session.hashcat.mode == 0 else 'Brute Force' }}</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Hash Type</div>
                        <div class="float-right"><abbr title="{{ supported_hashes[session.hashcat.hashtype] }}">{{ session.hashcat.hashtype }}</abbr></div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Wordlist</div>
                        <div class="float-right"><abbr title="{{ session.hashcat.wordlist_path }}">{{ session.hashcat.wordlist }}</abbr></div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Mask</div>
                        <div class="float-right">N/A</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-4">
        <div class="card">
            <h3 class="card-header">Progress</h3>
            <div class="card-body">
                <ul class="list-group">
                    <li class="list-group-item">
                        <div class="float-left">Status</div>
                        <div class="float-right">Running</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Passwords</div>
                        <div class="float-right">8/20</div>
                    </li>

                    <li class="list-group-item">
                        <div class="float-left">Elapsed / Remaining</div>
                        <div class="float-right">01:02:03 / 02:03:04</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="col-2"></div>
</div>
{% endblock %}